"use strict";var canv_bg=document.getElementById("canv_bg"),canv_ui=document.getElementById("canv_ui"),canv_main=document.getElementById("canv_main");canv_bg.width=.8*window.innerWidth,canv_bg.height=.8*window.innerWidth*9/16,canv_main.width=.8*window.innerWidth,canv_main.height=.8*window.innerWidth*9/16,canv_ui.width=.8*window.innerWidth,canv_ui.height=.8*window.innerWidth*9/16;var ctx_bg=canv_bg.getContext("2d"),ctx_ui=canv_ui.getContext("2d"),ctx_main=canv_main.getContext("2d"),cwidth=canv_bg.width,cheight=canv_bg.height,pwidth=10,pheight=cheight/10,max_speed=28,w_pressed=!1,s_pressed=!1,up_pressed=!1,down_pressed=!1,game_running=!1,curr_screen="game",player1={x:.1*cwidth,y:.4*cheight,score:0,color:"white",draw:function(){w_pressed&&(this.y=Math.max(this.y-10,0)),s_pressed&&(this.y=Math.min(this.y+10,cheight-pheight)),ctx_main.save(),ctx_main.fillStyle=this.color,ctx_main.fillRect(this.x,this.y,pwidth,pheight),ctx_main.restore()},reset:function(){this.score=0,this.x=.1*cwidth,this.y=.4*cheight}},player2={x:.9*cwidth,y:.4*cheight,score:0,color:"white",draw:function(){up_pressed&&(this.y=Math.max(this.y-10,0)),down_pressed&&(this.y=Math.min(this.y+10,cheight-pheight)),ctx_main.save(),ctx_main.fillStyle=this.color,ctx_main.fillRect(this.x,this.y,pwidth,pheight),ctx_main.restore()},reset:function(){this.score=0,this.x=.9*cwidth,this.y=.4*cheight}},ball={x:cwidth/2,y:cheight/2,vx:5,vy:2,radius:20,color:"white",draw:function(){ctx_main.save(),ctx_main.beginPath(),ctx_main.arc(this.x,this.y,this.radius,0,2*Math.PI,!0),ctx_main.closePath(),ctx_main.fillStyle=this.color,ctx_main.fill(),ctx_main.restore()},reset:function(){this.x=cwidth/2,this.y=cheight/2,this.vx=0,this.vy=0}};function keyDownHandler(e){switch(e.key){case"w":w_pressed=!0;break;case"s":s_pressed=!0;break;case"ArrowUp":up_pressed=!0;break;case"ArrowDown":down_pressed=!0}}function keyUpHandler(e){switch(e.key){case"w":w_pressed=!1;break;case"s":s_pressed=!1;break;case"ArrowUp":up_pressed=!1;break;case"ArrowDown":down_pressed=!1}}function draw_background(){ctx_bg.save(),ctx_bg.fillStyle="black",ctx_bg.fillRect(0,0,cwidth,cheight),ctx_bg.strokeStyle="white",ctx_bg.lineWidth=5,ctx_bg.setLineDash([20,10]),ctx_bg.lineDashOffset=5,ctx_bg.beginPath(),ctx_bg.moveTo(cwidth/2+.5,0),ctx_bg.lineTo(cwidth/2+.5,cheight),ctx_bg.stroke(),ctx_bg.restore()}function hit(e,t,i,a){var r=e,c=t;e<i?r=i:i+pwidth<e&&(r=i+pwidth),t<a?c=a:a+pheight<t&&(c=a+pheight);var n=e-r,l=t-c;return Math.sqrt(n*n+l*l)<=ball.radius}function draw_score(){ctx_ui.clearRect(0,0,cwidth,cheight),ctx_ui.save(),ctx_ui.font="50px Verdana",ctx_ui.fillStyle="white",ctx_ui.fillText("".concat(player1.score),.25*cwidth,75),ctx_ui.fillText("".concat(player2.score),.75*cwidth,75),ctx_ui.restore()}function init_game(){draw_background(),new_game(),draw_score(),draw()}function new_game(){ball.reset(),ball.vx=5,ball.vy=2,player1.reset(),player2.reset()}function game_over(e){ball.reset(),ctx_ui.save(),ctx_ui.font="50px Verdana",ctx_ui.fillStyle="white","player1"===e?ctx_ui.fillText("winner!",.2*cwidth,150):ctx_ui.fillText("winner!",.7*cwidth,150),ctx_ui.restore()}function draw(){if(ctx_main.clearRect(0,0,cwidth,cheight),player1.draw(),player2.draw(),ball.draw(),ball.x+=ball.vx,ball.y+=ball.vy,(ball.y+ball.vy+ball.radius>cheight||ball.y+ball.vy-ball.radius<0)&&(ball.vy=-ball.vy),ball.x+ball.vx+ball.radius>cwidth&&(player1.score+=1,draw_score(),10===player1.score?(game_over("player1"),game_running=!1,curr_screen="game_over"):(ball.reset(),ball.vx=5,ball.vy=2)),ball.x+ball.vx-ball.radius<0&&(player2.score+=1,draw_score(),10===player2.score?(game_over("player2"),game_running=!1,curr_screen="game_over"):(ball.reset(),ball.vx=-5,ball.vy=2)),hit(ball.x+ball.vx,ball.y+ball.vy,player1.x,player1.y)||hit(ball.x+ball.vx,ball.y+ball.vy,player2.x,player2.y)){var e=Math.min(max_speed,Math.abs(ball.vx)+1);ball.vx=0<ball.vx?-1*e:e}game_running&&window.requestAnimationFrame(draw)}init_game(),document.addEventListener("keydown",keyDownHandler,!1),document.addEventListener("keyup",keyUpHandler,!1),canv_ui.addEventListener("click",function(e){"game"===curr_screen?(game_running=!game_running,draw()):"game_over"===curr_screen&&(new_game(),draw_score(),curr_screen="game",game_running=!0,draw())});